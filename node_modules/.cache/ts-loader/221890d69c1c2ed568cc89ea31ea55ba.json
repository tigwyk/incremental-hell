{"remainingRequest":"C:\\Users\\Lee\\Documents\\GitHub\\incremental-hell\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\Lee\\Documents\\GitHub\\incremental-hell\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Lee\\Documents\\GitHub\\incremental-hell\\node_modules\\ts-loader\\index.js??ref--15-3!C:\\Users\\Lee\\Documents\\GitHub\\incremental-hell\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\Users\\Lee\\Documents\\GitHub\\incremental-hell\\src\\engine\\Game.ts","dependencies":[{"path":"C:\\Users\\Lee\\Documents\\GitHub\\incremental-hell\\src\\engine\\Game.ts","mtime":1655349015125},{"path":"C:\\Users\\Lee\\Documents\\GitHub\\incremental-hell\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1655266380406},{"path":"C:\\Users\\Lee\\Documents\\GitHub\\incremental-hell\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1655266380416},{"path":"C:\\Users\\Lee\\Documents\\GitHub\\incremental-hell\\node_modules\\babel-loader\\lib\\index.js","mtime":1655266380353},{"path":"C:\\Users\\Lee\\Documents\\GitHub\\incremental-hell\\node_modules\\ts-loader\\index.js","mtime":1655266386985},{"path":"C:\\Users\\Lee\\Documents\\GitHub\\incremental-hell\\node_modules\\eslint-loader\\index.js","mtime":1655266386089}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIkM6L1VzZXJzL0xlZS9Eb2N1bWVudHMvR2l0SHViL2luY3JlbWVudGFsLWhlbGwvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIuanMiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkM6L1VzZXJzL0xlZS9Eb2N1bWVudHMvR2l0SHViL2luY3JlbWVudGFsLWhlbGwvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrLmpzIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJDOi9Vc2Vycy9MZWUvRG9jdW1lbnRzL0dpdEh1Yi9pbmNyZW1lbnRhbC1oZWxsL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci5jb25zdHJ1Y3Rvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC52YWx1ZXMuanMiOwppbXBvcnQgeyBHYW1lU3RhdGUgfSBmcm9tICIuL0dhbWVTdGF0ZSI7CmltcG9ydCB7IExvY2FsU3RvcmFnZSB9IGZyb20gIkAvZW5naW5lL3Rvb2xzL3NhdmluZy9Mb2NhbFN0b3JhZ2UiOwppbXBvcnQgeyBEZXZlbG9wZXJQYW5lbCB9IGZyb20gIkAvZW5naW5lL2RldmVsb3Blci1wYW5lbC9EZXZlbG9wZXJQYW5lbCI7CmltcG9ydCB7IERldmVsb3BlclBhbmVsVGFiIH0gZnJvbSAiQC9lbmdpbmUvZGV2ZWxvcGVyLXBhbmVsL0RldmVsb3BlclBhbmVsVGFiIjsKaW1wb3J0IHsgRnVuY3Rpb25GaWVsZCB9IGZyb20gIkAvZW5naW5lL2RldmVsb3Blci1wYW5lbC9maWVsZHMvRnVuY3Rpb25GaWVsZCI7CmltcG9ydCB7IERpc3BsYXlGaWVsZCB9IGZyb20gIkAvZW5naW5lL2RldmVsb3Blci1wYW5lbC9maWVsZHMvRGlzcGxheUZpZWxkIjsKaW1wb3J0IHsgQ2hvaWNlRmllbGQgfSBmcm9tICJAL2VuZ2luZS9kZXZlbG9wZXItcGFuZWwvZmllbGRzL0Nob2ljZUZpZWxkIjsKaW1wb3J0IHsgU2lnbmFsRGlzcGF0Y2hlciB9IGZyb20gInN0cm9uZ2x5LXR5cGVkLWV2ZW50cyI7CmV4cG9ydCB2YXIgR2FtZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gR2FtZShmZWF0dXJlcykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEdhbWUpOwoKICAgIHRoaXMuX3RpY2tJbnRlcnZhbCA9IC0xOwogICAgdGhpcy5USUNLX0RVUkFUSU9OID0gMC4xOwogICAgdGhpcy5TQVZFX0lOVEVSVkFMID0gMzA7CiAgICB0aGlzLl9uZXh0U2F2ZSA9IHRoaXMuU0FWRV9JTlRFUlZBTDsKICAgIHRoaXMuZ2FtZVNwZWVkID0gMTsKICAgIHRoaXMuX2xhc3RVcGRhdGUgPSAwOwogICAgLyoqDQogICAgICogRW1pdHRlZCB3aGVuZXZlciB0aGUgZ2FtZSBzYXZlcw0KICAgICAqLwoKICAgIHRoaXMuX29uU2F2ZSA9IG5ldyBTaWduYWxEaXNwYXRjaGVyKCk7CiAgICAvKioNCiAgICAgKiBNYWtlIHN1cmUgdGhpcyBrZXkgaXMgdW5pcXVlIHRvIHlvdXIgZ2FtZS4NCiAgICAgKiBPdGhlcndpc2UgeW91IG1pZ2h0IHJ1biBpbnRvIGxvYWRpbmcgY29uZmxpY3RzIHdoZW4gbXVsdGlwbGUgZ2FtZXMgYXJlIGhvc3RlZCBvbiB0aGUgc2FtZSBkb21haW4gKHN1Y2ggYXMgPHVzZXJuYW1lLmdpdGh1Yi5pby9nYW1lKQ0KICAgICAqLwoKICAgIHRoaXMuU0FWRV9LRVkgPSAiaW5jcmVtZW50YWwtaGVsbCI7CiAgICB0aGlzLmZlYXR1cmVzID0gZmVhdHVyZXM7CiAgICB0aGlzLnN0YXRlID0gR2FtZVN0YXRlLkxhdW5jaGluZzsKICB9CgogIF9jcmVhdGVDbGFzcyhHYW1lLCBbewogICAga2V5OiAib25TYXZlIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fb25TYXZlLmFzRXZlbnQoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXREZXZlbG9wZXJQYW5lbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGV2ZWxvcGVyUGFuZWwoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvLyBTdGFydCB3aXRoIHBsYXkgYnV0dG9ucyBmb3IgdGhlIGdhbWUKICAgICAgdmFyIHRhYnMgPSBbbmV3IERldmVsb3BlclBhbmVsVGFiKCdHYW1lJywgW25ldyBEaXNwbGF5RmllbGQoJ3N0YXRlJywgJ1N0YXRlJykuc2V0T2JqZWN0KHRoaXMpLCBuZXcgQ2hvaWNlRmllbGQoJ2dhbWVTcGVlZCcsIFtbJzAuNXgnLCAwLjVdLCBbJzF4JywgMV0sIFsnMngnLCAyXSwgWyc0eCcsIDRdXSwgJ0dhbWUgc3BlZWQnKS5zZXRPYmplY3QodGhpcyksIG5ldyBGdW5jdGlvbkZpZWxkKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpcy5zdGFydCgpOwogICAgICB9LCAnU3RhcnQnKS5zZXRDc3NDbGFzcygnYnRuLWdyZWVuJyksIG5ldyBGdW5jdGlvbkZpZWxkKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpcy5wYXVzZSgpOwogICAgICB9LCAnUGF1c2UnKS5zZXRDc3NDbGFzcygnYnRuLWJsdWUnKSwgbmV3IEZ1bmN0aW9uRmllbGQoZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzLnJlc3VtZSgpOwogICAgICB9LCAnUmVzdW1lJykuc2V0Q3NzQ2xhc3MoJ2J0bi1ncmVlbicpLCBuZXcgRnVuY3Rpb25GaWVsZChmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMuc3RvcCgpOwogICAgICB9LCAnU3RvcCcpLnNldENzc0NsYXNzKCdidG4tcmVkJyldKV07CgogICAgICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5mZWF0dXJlTGlzdCksCiAgICAgICAgICBfc3RlcDsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBmZWF0dXJlID0gX3N0ZXAudmFsdWU7CiAgICAgICAgICB2YXIgZmllbGRzID0gZmVhdHVyZS5nZXREZXZlbG9wZXJQYW5lbEZpZWxkcygpOyAvLyBJbmplY3QgdGhlIGZlYXR1cmUgaW50byB0aGUgcmVzb3VyY2UuCgogICAgICAgICAgdmFyIF9pdGVyYXRvcjIgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihmaWVsZHMpLAogICAgICAgICAgICAgIF9zdGVwMjsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBmb3IgKF9pdGVyYXRvcjIucygpOyAhKF9zdGVwMiA9IF9pdGVyYXRvcjIubigpKS5kb25lOykgewogICAgICAgICAgICAgIHZhciBmaWVsZCA9IF9zdGVwMi52YWx1ZTsKICAgICAgICAgICAgICBmaWVsZC5zZXRPYmplY3QoZmVhdHVyZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTsKICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjIuZigpOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciB0YWIgPSBuZXcgRGV2ZWxvcGVyUGFuZWxUYWIoZmVhdHVyZS5zYXZlS2V5LCBmaWVsZHMpOwoKICAgICAgICAgIGlmICghdGFiLmlzRW1wdHkoKSkgewogICAgICAgICAgICB0YWJzLnB1c2godGFiKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBEZXZlbG9wZXJQYW5lbCh0YWJzKTsKICAgIH0KICAgIC8qKg0KICAgICAqIFVwZGF0ZSBhbGwgZmVhdHVyZXMNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAidXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGUoKSB7CiAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDA7CiAgICAgIHZhciB0aW1lRGlmZmVyZW5jZSA9IG5vdyAtIHRoaXMuX2xhc3RVcGRhdGU7CgogICAgICBpZiAodGhpcy5zdGF0ZSAhPSBHYW1lU3RhdGUuUGxheWluZykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGRlbHRhID0gdGltZURpZmZlcmVuY2UgKiB0aGlzLmdhbWVTcGVlZDsKCiAgICAgIHZhciBfaXRlcmF0b3IzID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5mZWF0dXJlTGlzdCksCiAgICAgICAgICBfc3RlcDM7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yMy5zKCk7ICEoX3N0ZXAzID0gX2l0ZXJhdG9yMy5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgZmVhdHVyZSA9IF9zdGVwMy52YWx1ZTsKICAgICAgICAgIGZlYXR1cmUudXBkYXRlKGRlbHRhKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjMuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjMuZigpOwogICAgICB9CgogICAgICB0aGlzLl9sYXN0VXBkYXRlID0gbm93OwogICAgICB0aGlzLl9uZXh0U2F2ZSAtPSBkZWx0YTsKCiAgICAgIGlmICh0aGlzLl9uZXh0U2F2ZSA8PSAwKSB7CiAgICAgICAgdGhpcy5zYXZlKCk7CiAgICAgICAgdGhpcy5fbmV4dFNhdmUgPSB0aGlzLlNBVkVfSU5URVJWQUw7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRUb3RhbEN1cnJlbmN5TXVsdGlwbGllciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VG90YWxDdXJyZW5jeU11bHRpcGxpZXIodHlwZSkgewogICAgICB2YXIgbXVsdGlwbGllciA9IDE7CgogICAgICB2YXIgX2l0ZXJhdG9yNCA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMuZmVhdHVyZUxpc3QpLAogICAgICAgICAgX3N0ZXA0OwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjQucygpOyAhKF9zdGVwNCA9IF9pdGVyYXRvcjQubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGZlYXR1cmUgPSBfc3RlcDQudmFsdWU7CiAgICAgICAgICBtdWx0aXBsaWVyICo9IGZlYXR1cmUuZ2V0VG90YWxDdXJyZW5jeU11bHRpcGxpZXIodHlwZSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3I0LmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3I0LmYoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG11bHRpcGxpZXI7CiAgICB9CiAgICAvKioNCiAgICAgKiBJbml0aWFsaXplIGFsbCBmZWF0dXJlcw0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJpbml0aWFsaXplIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplKCkgewogICAgICB2YXIgX2l0ZXJhdG9yNSA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMuZmVhdHVyZUxpc3QpLAogICAgICAgICAgX3N0ZXA1OwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjUucygpOyAhKF9zdGVwNSA9IF9pdGVyYXRvcjUubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGZlYXR1cmUgPSBfc3RlcDUudmFsdWU7CiAgICAgICAgICBmZWF0dXJlLmluaXRpYWxpemUodGhpcy5mZWF0dXJlcyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3I1LmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3I1LmYoKTsKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICogU3RhcnQgdGhlIG1haW4gdXBkYXRlIGxvb3ANCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAic3RhcnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN0YXJ0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGlmICh0aGlzLnN0YXRlICE9PSBHYW1lU3RhdGUuU3RvcHBlZCAmJiB0aGlzLnN0YXRlICE9PSBHYW1lU3RhdGUuTGF1bmNoaW5nKSB7CiAgICAgICAgdGhpcy5wcmludFN0YXRlV2FybmluZygiQ2Fubm90IHN0YXJ0IHRoZSBnYW1lIHR3aWNlLiIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIF9pdGVyYXRvcjYgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLmZlYXR1cmVMaXN0KSwKICAgICAgICAgIF9zdGVwNjsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3I2LnMoKTsgIShfc3RlcDYgPSBfaXRlcmF0b3I2Lm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBmZWF0dXJlID0gX3N0ZXA2LnZhbHVlOwogICAgICAgICAgZmVhdHVyZS5zdGFydCgpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yNi5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yNi5mKCk7CiAgICAgIH0KCiAgICAgIHRoaXMuX2xhc3RVcGRhdGUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDA7CiAgICAgIHRoaXMuX3RpY2tJbnRlcnZhbCA9IE51bWJlcihzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi51cGRhdGUoKTsKICAgICAgfSwgdGhpcy5USUNLX0RVUkFUSU9OICogMTAwMCkpOwogICAgICB0aGlzLnN0YXRlID0gR2FtZVN0YXRlLlBsYXlpbmc7CiAgICAgIGNvbnNvbGUuZGVidWcoIkdhbWUgU3RhcnRlZCIpOwogICAgfQogIH0sIHsKICAgIGtleTogInBhdXNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwYXVzZSgpIHsKICAgICAgaWYgKHRoaXMuc3RhdGUgIT09IEdhbWVTdGF0ZS5QbGF5aW5nKSB7CiAgICAgICAgdGhpcy5wcmludFN0YXRlV2FybmluZygiQ2Fubm90IHBhdXNlIHRoZSBnYW1lIGlmIHdlJ3JlIG5vdCBwbGF5aW5nLiIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLl90aWNrSW50ZXJ2YWwpOwogICAgICB0aGlzLnN0YXRlID0gR2FtZVN0YXRlLlBhdXNlZDsKICAgICAgY29uc29sZS5kZWJ1ZygiR2FtZSBQYXVzZWQiKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXN1bWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZSgpIHsKICAgICAgaWYgKHRoaXMuc3RhdGUgIT09IEdhbWVTdGF0ZS5QYXVzZWQpIHsKICAgICAgICB0aGlzLnByaW50U3RhdGVXYXJuaW5nKCJDYW5ub3QgcmVzdW1lIHRoZSBnYW1lIGlmIHdlJ3JlIG5vdCBwYXVzZWQuIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLl9sYXN0VXBkYXRlID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwOyAvLyB0aGlzLl90aWNrSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB0aGlzLnVwZGF0ZSgpLCB0aGlzLlRJQ0tfRFVSQVRJT04gKiAxMDAwKTsKCiAgICAgIHRoaXMuc3RhdGUgPSBHYW1lU3RhdGUuUGxheWluZzsKICAgICAgY29uc29sZS5kZWJ1ZygiR2FtZSBSZXN1bWVkIik7CiAgICB9CiAgICAvKioNCiAgICAgKiBTdG9wIHRoZSBtYWluIHVwZGF0ZSBsb29wDQogICAgICovCgogIH0sIHsKICAgIGtleTogInN0b3AiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN0b3AoKSB7CiAgICAgIGlmICh0aGlzLnN0YXRlID09PSBHYW1lU3RhdGUuU3RvcHBlZCkgewogICAgICAgIHRoaXMucHJpbnRTdGF0ZVdhcm5pbmcoIkNhbm5vdCBzdG9wIHRoZSBnYW1lIGlmIHdlJ3JlIGFscmVhZHkgc3RvcHBlZC4iKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5fdGlja0ludGVydmFsKTsKCiAgICAgIHZhciBfaXRlcmF0b3I3ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5mZWF0dXJlTGlzdCksCiAgICAgICAgICBfc3RlcDc7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yNy5zKCk7ICEoX3N0ZXA3ID0gX2l0ZXJhdG9yNy5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgZmVhdHVyZSA9IF9zdGVwNy52YWx1ZTsKICAgICAgICAgIGZlYXR1cmUuc3RvcCgpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yNy5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yNy5mKCk7CiAgICAgIH0KCiAgICAgIHRoaXMuc3RhdGUgPSBHYW1lU3RhdGUuU3RvcHBlZDsKICAgICAgY29uc29sZS5kZWJ1ZygiU3RvcHBlZCIpOwogICAgfQogICAgLyoqDQogICAgICogUmVjdXJzaXZlbHkgc2F2ZSBhbGwgcmVnaXN0ZXJlZCBmZWF0dXJlcw0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJzYXZlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzYXZlKCkgewogICAgICB2YXIgcmVzID0ge307CgogICAgICB2YXIgX2l0ZXJhdG9yOCA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMuZmVhdHVyZUxpc3QpLAogICAgICAgICAgX3N0ZXA4OwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjgucygpOyAhKF9zdGVwOCA9IF9pdGVyYXRvcjgubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGZlYXR1cmUgPSBfc3RlcDgudmFsdWU7CiAgICAgICAgICByZXNbZmVhdHVyZS5zYXZlS2V5XSA9IGZlYXR1cmUuc2F2ZSgpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yOC5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yOC5mKCk7CiAgICAgIH0KCiAgICAgIExvY2FsU3RvcmFnZS5zdG9yZSh0aGlzLlNBVkVfS0VZLCByZXMpOwoKICAgICAgdGhpcy5fb25TYXZlLmRpc3BhdGNoKCk7CiAgICB9CiAgICAvKioNCiAgICAgKiBEZWxldGUgdGhlIGxvY2FsbHkgc3RvcmVkIHNhdmUNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZGVsZXRlU2F2ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGVsZXRlU2F2ZSgpIHsKICAgICAgTG9jYWxTdG9yYWdlLmRlbGV0ZSh0aGlzLlNBVkVfS0VZKTsKICAgIH0KICAgIC8qKg0KICAgICAqIFJlY3Vyc2l2ZWx5IGxvYWQgYWxsIHJlZ2lzdGVyZWQgZmVhdHVyZXMNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAibG9hZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZCgpIHsKICAgICAgdmFyIHNhdmVEYXRhID0gTG9jYWxTdG9yYWdlLmdldCh0aGlzLlNBVkVfS0VZKTsKCiAgICAgIGlmIChzYXZlRGF0YSA9PSBudWxsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgX2l0ZXJhdG9yOSA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMuZmVhdHVyZUxpc3QpLAogICAgICAgICAgX3N0ZXA5OwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjkucygpOyAhKF9zdGVwOSA9IF9pdGVyYXRvcjkubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGZlYXR1cmUgPSBfc3RlcDkudmFsdWU7CiAgICAgICAgICB2YXIgZmVhdHVyZVNhdmVEYXRhID0gc2F2ZURhdGFbZmVhdHVyZS5zYXZlS2V5XTsKCiAgICAgICAgICBpZiAoZmVhdHVyZVNhdmVEYXRhID09IG51bGwpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgZmVhdHVyZS5sb2FkKGZlYXR1cmVTYXZlRGF0YSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3I5LmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3I5LmYoKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInByaW50U3RhdGVXYXJuaW5nIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwcmludFN0YXRlV2FybmluZyhyZWFzb24pIHsKICAgICAgY29uc29sZS53YXJuKCJDdXJyZW50IHN0YXRlID0gIi5jb25jYXQodGhpcy5zdGF0ZSwgIi4iKSwgcmVhc29uKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmZWF0dXJlTGlzdCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXModGhpcy5mZWF0dXJlcyk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gR2FtZTsKfSgpOw=="},{"version":3,"sources":["C:\\Users\\Lee\\Documents\\GitHub\\incremental-hell\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\Users\\Lee\\Documents\\GitHub\\incremental-hell\\src\\engine\\Game.ts"],"names":[],"mappings":";;;;;AAAA,SAAQ,SAAR,QAAwB,aAAxB;AACA,SAAQ,YAAR,QAA2B,oCAA3B;AAIA,SAAQ,cAAR,QAA6B,yCAA7B;AACA,SAAQ,iBAAR,QAAgC,4CAAhC;AACA,SAAQ,aAAR,QAA4B,+CAA5B;AACA,SAAQ,YAAR,QAA2B,8CAA3B;AACA,SAAQ,WAAR,QAA0B,6CAA1B;AAEA,SAA+B,gBAA/B,QAA6E,uBAA7E;AAEA,WAAa,IAAb;EAiCI,cAAY,QAAZ,EAA8B;IAAA;;IAhCtB,KAAA,aAAA,GAAwB,CAAC,CAAzB;IAUW,KAAA,aAAA,GAAwB,GAAxB;IACF,KAAA,aAAA,GAAgB,EAAhB;IACT,KAAA,SAAA,GAAY,KAAK,aAAjB;IAEA,KAAA,SAAA,GAAY,CAAZ;IACA,KAAA,WAAA,GAAsB,CAAtB;IAER;;AAEG;;IACK,KAAA,OAAA,GAAU,IAAI,gBAAJ,EAAV;IAMR;;;AAGG;;IACgB,KAAA,QAAA,GAAmB,kBAAnB;IAGf,KAAK,QAAL,GAAgB,QAAhB;IAEA,KAAK,KAAL,GAAa,SAAS,CAAC,SAAvB;EACH;;EArCL;IAAA;IAAA,KAuBI,eAAiB;MACb,OAAO,KAAK,OAAL,CAAa,OAAb,EAAP;IACH;EAzBL;IAAA;IAAA,OAuCW,6BAAiB;MAAA;;MACpB;MACA,IAAM,IAAI,GAAwB,CAC9B,IAAI,iBAAJ,CAAsB,MAAtB,EAA8B,CAC1B,IAAI,YAAJ,CAAiB,OAAjB,EAA0B,OAA1B,EAAmC,SAAnC,CAA6C,IAA7C,CAD0B,EAE1B,IAAI,WAAJ,CAAgB,WAAhB,EAA6B,CACzB,CAAC,MAAD,EAAS,GAAT,CADyB,EAEzB,CAAC,IAAD,EAAO,CAAP,CAFyB,EAGzB,CAAC,IAAD,EAAO,CAAP,CAHyB,EAIzB,CAAC,IAAD,EAAO,CAAP,CAJyB,CAA7B,EAKG,YALH,EAKiB,SALjB,CAK2B,IAL3B,CAF0B,EAQ1B,IAAI,aAAJ,CAAkB,YAAK;QACnB,KAAI,CAAC,KAAL;MACH,CAFD,EAEG,OAFH,EAEY,WAFZ,CAEwB,WAFxB,CAR0B,EAW1B,IAAI,aAAJ,CAAkB,YAAK;QACnB,KAAI,CAAC,KAAL;MACH,CAFD,EAEG,OAFH,EAEY,WAFZ,CAEwB,UAFxB,CAX0B,EAc1B,IAAI,aAAJ,CAAkB,YAAK;QACnB,KAAI,CAAC,MAAL;MACH,CAFD,EAEG,QAFH,EAEa,WAFb,CAEyB,WAFzB,CAd0B,EAiB1B,IAAI,aAAJ,CAAkB,YAAK;QACnB,KAAI,CAAC,IAAL;MACH,CAFD,EAEG,MAFH,EAEW,WAFX,CAEuB,SAFvB,CAjB0B,CAA9B,CAD8B,CAAlC;;MAFoB,2CA4BE,KAAK,WA5BP;MAAA;;MAAA;QA4BpB,oDAAwC;UAAA,IAA7B,OAA6B;UACpC,IAAM,MAAM,GAAG,OAAO,CAAC,uBAAR,EAAf,CADoC,CAGpC;;UAHoC,4CAIhB,MAJgB;UAAA;;UAAA;YAIpC,uDAA4B;cAAA,IAAjB,KAAiB;cACxB,KAAK,CAAC,SAAN,CAAgB,OAAhB;YACH;UANmC;YAAA;UAAA;YAAA;UAAA;;UAQpC,IAAM,GAAG,GAAG,IAAI,iBAAJ,CAAsB,OAAO,CAAC,OAA9B,EAAuC,MAAvC,CAAZ;;UACA,IAAI,CAAC,GAAG,CAAC,OAAJ,EAAL,EAAoB;YAChB,IAAI,CAAC,IAAL,CAAU,GAAV;UACH;QACJ;MAxCmB;QAAA;MAAA;QAAA;MAAA;;MAyCpB,OAAO,IAAI,cAAJ,CAAmB,IAAnB,CAAP;IACH;IAED;;AAEG;;EArFP;IAAA;IAAA,OAsFW,kBAAM;MACT,IAAM,GAAG,GAAG,IAAI,IAAJ,GAAW,OAAX,KAAuB,IAAnC;MACA,IAAM,cAAc,GAAG,GAAG,GAAG,KAAK,WAAlC;;MAEA,IAAI,KAAK,KAAL,IAAc,SAAS,CAAC,OAA5B,EAAqC;QACjC;MACH;;MAED,IAAM,KAAK,GAAG,cAAc,GAAG,KAAK,SAApC;;MARS,4CASa,KAAK,WATlB;MAAA;;MAAA;QAST,uDAAwC;UAAA,IAA7B,OAA6B;UACpC,OAAO,CAAC,MAAR,CAAe,KAAf;QACH;MAXQ;QAAA;MAAA;QAAA;MAAA;;MAaT,KAAK,WAAL,GAAmB,GAAnB;MACA,KAAK,SAAL,IAAkB,KAAlB;;MACA,IAAI,KAAK,SAAL,IAAkB,CAAtB,EAAyB;QACrB,KAAK,IAAL;QACA,KAAK,SAAL,GAAiB,KAAK,aAAtB;MACH;IACJ;EAzGL;IAAA;IAAA,OA2GW,oCAA2B,IAA3B,EAA6C;MAChD,IAAI,UAAU,GAAG,CAAjB;;MADgD,4CAE1B,KAAK,WAFqB;MAAA;;MAAA;QAEhD,uDAAwC;UAAA,IAA7B,OAA6B;UACpC,UAAU,IAAI,OAAO,CAAC,0BAAR,CAAmC,IAAnC,CAAd;QACH;MAJ+C;QAAA;MAAA;QAAA;MAAA;;MAKhD,OAAO,UAAP;IACH;IAED;;AAEG;;EArHP;IAAA;IAAA,OAsHW,sBAAU;MAAA,4CACS,KAAK,WADd;MAAA;;MAAA;QACb,uDAAwC;UAAA,IAA7B,OAA6B;UACpC,OAAO,CAAC,UAAR,CAAmB,KAAK,QAAxB;QACH;MAHY;QAAA;MAAA;QAAA;MAAA;IAIhB;IAGD;;AAEG;;EA/HP;IAAA;IAAA,OAgIW,iBAAK;MAAA;;MACR,IAAI,KAAK,KAAL,KAAe,SAAS,CAAC,OAAzB,IAAoC,KAAK,KAAL,KAAe,SAAS,CAAC,SAAjE,EAA4E;QACxE,KAAK,iBAAL,CAAuB,8BAAvB;QACA;MACH;;MAJO,4CAMc,KAAK,WANnB;MAAA;;MAAA;QAMR,uDAAwC;UAAA,IAA7B,OAA6B;UACpC,OAAO,CAAC,KAAR;QACH;MARO;QAAA;MAAA;QAAA;MAAA;;MAUR,KAAK,WAAL,GAAmB,IAAI,IAAJ,GAAW,OAAX,KAAuB,IAA1C;MACA,KAAK,aAAL,GAAqB,MAAM,CAAC,WAAW,CAAC;QAAA,OAAM,MAAI,CAAC,MAAL,EAAN;MAAA,CAAD,EAAsB,KAAK,aAAL,GAAqB,IAA3C,CAAZ,CAA3B;MAEA,KAAK,KAAL,GAAa,SAAS,CAAC,OAAvB;MACA,OAAO,CAAC,KAAR,CAAc,cAAd;IACH;EA/IL;IAAA;IAAA,OAiJW,iBAAK;MACR,IAAI,KAAK,KAAL,KAAe,SAAS,CAAC,OAA7B,EAAsC;QAClC,KAAK,iBAAL,CAAuB,6CAAvB;QACA;MACH;;MACD,aAAa,CAAC,KAAK,aAAN,CAAb;MAEA,KAAK,KAAL,GAAa,SAAS,CAAC,MAAvB;MACA,OAAO,CAAC,KAAR,CAAc,aAAd;IACH;EA1JL;IAAA;IAAA,OA6JW,kBAAM;MACT,IAAI,KAAK,KAAL,KAAe,SAAS,CAAC,MAA7B,EAAqC;QACjC,KAAK,iBAAL,CAAuB,6CAAvB;QACA;MACH;;MAED,KAAK,WAAL,GAAmB,IAAI,IAAJ,GAAW,OAAX,KAAuB,IAA1C,CANS,CAOT;;MAEA,KAAK,KAAL,GAAa,SAAS,CAAC,OAAvB;MACA,OAAO,CAAC,KAAR,CAAc,cAAd;IACH;IAED;;AAEG;;EA5KP;IAAA;IAAA,OA6KW,gBAAI;MACP,IAAI,KAAK,KAAL,KAAe,SAAS,CAAC,OAA7B,EAAsC;QAClC,KAAK,iBAAL,CAAuB,gDAAvB;QACA;MACH;;MACD,aAAa,CAAC,KAAK,aAAN,CAAb;;MALO,4CAOe,KAAK,WAPpB;MAAA;;MAAA;QAOP,uDAAwC;UAAA,IAA7B,OAA6B;UACpC,OAAO,CAAC,IAAR;QACH;MATM;QAAA;MAAA;QAAA;MAAA;;MAWP,KAAK,KAAL,GAAa,SAAS,CAAC,OAAvB;MACA,OAAO,CAAC,KAAR,CAAc,SAAd;IACH;IAED;;AAEG;;EA9LP;IAAA;IAAA,OA+LW,gBAAI;MACP,IAAM,GAAG,GAA4B,EAArC;;MADO,4CAEe,KAAK,WAFpB;MAAA;;MAAA;QAEP,uDAAwC;UAAA,IAA7B,OAA6B;UACpC,GAAG,CAAC,OAAO,CAAC,OAAT,CAAH,GAAuB,OAAO,CAAC,IAAR,EAAvB;QACH;MAJM;QAAA;MAAA;QAAA;MAAA;;MAKP,YAAY,CAAC,KAAb,CAAmB,KAAK,QAAxB,EAAkC,GAAlC;;MACA,KAAK,OAAL,CAAa,QAAb;IACH;IAED;;AAEG;;EA1MP;IAAA;IAAA,OA2MW,sBAAU;MACb,YAAY,CAAC,MAAb,CAAoB,KAAK,QAAzB;IACH;IAED;;AAEG;;EAjNP;IAAA;IAAA,OAkNW,gBAAI;MACP,IAAM,QAAQ,GAAG,YAAY,CAAC,GAAb,CAAiB,KAAK,QAAtB,CAAjB;;MACA,IAAI,QAAQ,IAAI,IAAhB,EAAsB;QAClB;MACH;;MAJM,4CAKe,KAAK,WALpB;MAAA;;MAAA;QAKP,uDAAwC;UAAA,IAA7B,OAA6B;UACpC,IAAM,eAAe,GAA4B,QAAQ,CAAC,OAAO,CAAC,OAAT,CAAzD;;UACA,IAAI,eAAe,IAAI,IAAvB,EAA6B;YACzB;UACH;;UACD,OAAO,CAAC,IAAR,CAAa,eAAb;QACH;MAXM;QAAA;MAAA;QAAA;MAAA;IAYV;EA9NL;IAAA;IAAA,OAgOY,2BAAkB,MAAlB,EAAgC;MACpC,OAAO,CAAC,IAAR,2BAAgC,KAAK,KAArC,QAA+C,MAA/C;IACH;EAlOL;IAAA;IAAA,KAoOI,eAAuB;MACnB,OAAO,MAAM,CAAC,MAAP,CAAc,KAAK,QAAnB,CAAP;IACH;EAtOL;;EAAA;AAAA","sourcesContent":["import {GameState} from \"./GameState\";\r\nimport {LocalStorage} from \"@/engine/tools/saving/LocalStorage\";\r\nimport {CurrencyType} from \"@/engine/features/wallet/CurrencyType\";\r\nimport {Features} from \"@/engine/Features\";\r\nimport {Feature} from \"@/engine/features/Feature\";\r\nimport {DeveloperPanel} from \"@/engine/developer-panel/DeveloperPanel\";\r\nimport {DeveloperPanelTab} from \"@/engine/developer-panel/DeveloperPanelTab\";\r\nimport {FunctionField} from \"@/engine/developer-panel/fields/FunctionField\";\r\nimport {DisplayField} from \"@/engine/developer-panel/fields/DisplayField\";\r\nimport {ChoiceField} from \"@/engine/developer-panel/fields/ChoiceField\";\r\nimport {Currency} from \"@/engine/features/wallet/Currency\";\r\nimport {ISignal, ISimpleEvent, SignalDispatcher, SimpleEventDispatcher} from \"strongly-typed-events\";\r\n\r\nexport class Game {\r\n    private _tickInterval: number = -1;\r\n\r\n    /**\r\n     * Object with registered features. If you want them as a list use this.featureList\r\n     */\r\n    public readonly features: Features;\r\n\r\n    public state: GameState;\r\n\r\n\r\n    protected readonly TICK_DURATION: number = 0.1;\r\n    private readonly SAVE_INTERVAL = 30;\r\n    private _nextSave = this.SAVE_INTERVAL;\r\n\r\n    private gameSpeed = 1;\r\n    private _lastUpdate: number = 0;\r\n\r\n    /**\r\n     * Emitted whenever the game saves\r\n     */\r\n    private _onSave = new SignalDispatcher();\r\n\r\n    public get onSave(): ISignal {\r\n        return this._onSave.asEvent();\r\n    }\r\n\r\n    /**\r\n     * Make sure this key is unique to your game.\r\n     * Otherwise you might run into loading conflicts when multiple games are hosted on the same domain (such as <username.github.io/game)\r\n     */\r\n    protected readonly SAVE_KEY: string = \"incremental-hell\";\r\n\r\n    constructor(features: Features) {\r\n        this.features = features;\r\n\r\n        this.state = GameState.Launching;\r\n    }\r\n\r\n    public getDeveloperPanel(): DeveloperPanel {\r\n        // Start with play buttons for the game\r\n        const tabs: DeveloperPanelTab[] = [\r\n            new DeveloperPanelTab('Game', [\r\n                new DisplayField('state', 'State').setObject(this),\r\n                new ChoiceField('gameSpeed', [\r\n                    ['0.5x', 0.5],\r\n                    ['1x', 1],\r\n                    ['2x', 2],\r\n                    ['4x', 4],\r\n                ], 'Game speed').setObject(this),\r\n                new FunctionField(() => {\r\n                    this.start()\r\n                }, 'Start').setCssClass('btn-green'),\r\n                new FunctionField(() => {\r\n                    this.pause()\r\n                }, 'Pause').setCssClass('btn-blue'),\r\n                new FunctionField(() => {\r\n                    this.resume()\r\n                }, 'Resume').setCssClass('btn-green'),\r\n                new FunctionField(() => {\r\n                    this.stop()\r\n                }, 'Stop').setCssClass('btn-red'),\r\n            ]),\r\n\r\n        ];\r\n\r\n\r\n        for (const feature of this.featureList) {\r\n            const fields = feature.getDeveloperPanelFields();\r\n\r\n            // Inject the feature into the resource.\r\n            for (const field of fields) {\r\n                field.setObject(feature);\r\n            }\r\n\r\n            const tab = new DeveloperPanelTab(feature.saveKey, fields)\r\n            if (!tab.isEmpty()) {\r\n                tabs.push(tab)\r\n            }\r\n        }\r\n        return new DeveloperPanel(tabs);\r\n    }\r\n\r\n    /**\r\n     * Update all features\r\n     */\r\n    public update(): void {\r\n        const now = new Date().getTime() / 1000;\r\n        const timeDifference = now - this._lastUpdate;\r\n\r\n        if (this.state != GameState.Playing) {\r\n            return;\r\n        }\r\n\r\n        const delta = timeDifference * this.gameSpeed;\r\n        for (const feature of this.featureList) {\r\n            feature.update(delta)\r\n        }\r\n\r\n        this._lastUpdate = now;\r\n        this._nextSave -= delta;\r\n        if (this._nextSave <= 0) {\r\n            this.save();\r\n            this._nextSave = this.SAVE_INTERVAL;\r\n        }\r\n    }\r\n\r\n    public getTotalCurrencyMultiplier(type: CurrencyType): number {\r\n        let multiplier = 1;\r\n        for (const feature of this.featureList) {\r\n            multiplier *= feature.getTotalCurrencyMultiplier(type);\r\n        }\r\n        return multiplier;\r\n    }\r\n\r\n    /**\r\n     * Initialize all features\r\n     */\r\n    public initialize(): void {\r\n        for (const feature of this.featureList) {\r\n            feature.initialize(this.features);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Start the main update loop\r\n     */\r\n    public start(): void {\r\n        if (this.state !== GameState.Stopped && this.state !== GameState.Launching) {\r\n            this.printStateWarning(\"Cannot start the game twice.\");\r\n            return;\r\n        }\r\n\r\n        for (const feature of this.featureList) {\r\n            feature.start();\r\n        }\r\n\r\n        this._lastUpdate = new Date().getTime() / 1000;\r\n        this._tickInterval = Number(setInterval(() => this.update(), this.TICK_DURATION * 1000));\r\n\r\n        this.state = GameState.Playing;\r\n        console.debug(\"Game Started\");\r\n    }\r\n\r\n    public pause(): void {\r\n        if (this.state !== GameState.Playing) {\r\n            this.printStateWarning(\"Cannot pause the game if we're not playing.\");\r\n            return;\r\n        }\r\n        clearInterval(this._tickInterval);\r\n\r\n        this.state = GameState.Paused;\r\n        console.debug(\"Game Paused\");\r\n    }\r\n\r\n\r\n    public resume(): void {\r\n        if (this.state !== GameState.Paused) {\r\n            this.printStateWarning(\"Cannot resume the game if we're not paused.\");\r\n            return;\r\n        }\r\n\r\n        this._lastUpdate = new Date().getTime() / 1000;\r\n        // this._tickInterval = setInterval(() => this.update(), this.TICK_DURATION * 1000);\r\n\r\n        this.state = GameState.Playing;\r\n        console.debug(\"Game Resumed\");\r\n    }\r\n\r\n    /**\r\n     * Stop the main update loop\r\n     */\r\n    public stop(): void {\r\n        if (this.state === GameState.Stopped) {\r\n            this.printStateWarning(\"Cannot stop the game if we're already stopped.\");\r\n            return;\r\n        }\r\n        clearInterval(this._tickInterval);\r\n\r\n        for (const feature of this.featureList) {\r\n            feature.stop();\r\n        }\r\n\r\n        this.state = GameState.Stopped;\r\n        console.debug(\"Stopped\");\r\n    }\r\n\r\n    /**\r\n     * Recursively save all registered features\r\n     */\r\n    public save(): void {\r\n        const res: Record<string, unknown> = {};\r\n        for (const feature of this.featureList) {\r\n            res[feature.saveKey] = feature.save()\r\n        }\r\n        LocalStorage.store(this.SAVE_KEY, res)\r\n        this._onSave.dispatch();\r\n    }\r\n\r\n    /**\r\n     * Delete the locally stored save\r\n     */\r\n    public deleteSave(): void {\r\n        LocalStorage.delete(this.SAVE_KEY);\r\n    }\r\n\r\n    /**\r\n     * Recursively load all registered features\r\n     */\r\n    public load(): void {\r\n        const saveData = LocalStorage.get(this.SAVE_KEY)\r\n        if (saveData == null) {\r\n            return;\r\n        }\r\n        for (const feature of this.featureList) {\r\n            const featureSaveData: Record<string, unknown> = saveData[feature.saveKey] as Record<string, unknown>;\r\n            if (featureSaveData == null) {\r\n                continue;\r\n            }\r\n            feature.load(featureSaveData);\r\n        }\r\n    }\r\n\r\n    private printStateWarning(reason: string): void {\r\n        console.warn(`Current state = ${this.state}.`, reason);\r\n    }\r\n\r\n    private get featureList(): Feature[] {\r\n        return Object.values(this.features)\r\n    }\r\n}\r\n"],"sourceRoot":""}]}